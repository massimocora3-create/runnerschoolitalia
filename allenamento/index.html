<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Runner‚Äôs School Italia ‚Äì Allenamento della settimana</title>

<style>
:root{
  --bg:#020617;
  --bg-card:#0b1120;
  --accent:#f97316;
  --text:#e5e7eb;
  --text-muted:#9ca3af;
  --border:#1f2937;
  --radius:20px;
  --shadow:0 18px 45px rgba(0,0,0,.55);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:radial-gradient(circle at top,#0b1120 0,#020617 55%,#000 100%);
  color:var(--text);
}
.app{
  max-width:520px;
  margin:0 auto;
  padding:18px 14px 90px;
}
.header{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
  margin-bottom:18px;
}
.header h1{margin:0;font-size:18px}
.header p{margin:6px 0 0;font-size:13px;color:var(--text-muted)}
.level-list{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.level{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:14px 16px;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.level.active{
  border-color:rgba(249,115,22,.6);
  background:rgba(249,115,22,.08);
}
.level-title{font-weight:800;font-size:14px;color:var(--accent)}
.level-sub{font-size:12px;color:var(--text-muted)}
.arrow{
  width:10px;height:10px;
  border-right:2px solid var(--text-muted);
  border-bottom:2px solid var(--text-muted);
  transform:rotate(-45deg);
}
details.week{
  margin-top:16px;
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
details.week summary{
  list-style:none;
  padding:14px 16px;
  cursor:pointer;
  font-weight:700;
}
details.week summary::-webkit-details-marker{display:none}
.week-content{padding:0 16px 16px;font-size:13px;line-height:1.45}
.back{
  position:fixed;
  bottom:18px;
  right:18px;
  width:48px;
  height:48px;
  background:var(--accent);
  color:#000;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  font-weight:700;
  text-decoration:none;
  box-shadow:0 10px 25px rgba(0,0,0,.5);
}
</style>
</head>

<body>

<a class="back" href="https://massimocora3-create.github.io/runnerschoolitalia/">‚Üê</a>

<div class="app">

  <div class="header">
    <h1>üî• Allenamento della settimana</h1>
    <p>Seleziona il tuo livello</p>
  </div>

  <div class="level-list">
    <div class="level" data-level="L1"><div><div class="level-title">üüß Livello 1</div><div class="level-sub">Base</div></div><div class="arrow"></div></div>
    <div class="level" data-level="L2S"><div><div class="level-title">üü¶ Livello 2 ‚Äì Sprint</div><div class="level-sub">Velocit√†</div></div><div class="arrow"></div></div>
    <div class="level" data-level="L2M"><div><div class="level-title">üü¶ Livello 2 ‚Äì Medio</div><div class="level-sub">Ritmo</div></div><div class="arrow"></div></div>
    <div class="level" data-level="L2E"><div><div class="level-title">üü¶ Livello 2 ‚Äì Endurance</div><div class="level-sub">Resistenza</div></div><div class="arrow"></div></div>
  </div>

  <div id="week">
    <p style="margin-top:16px;color:var(--text-muted)">
      Seleziona un livello per vedere l‚Äôallenamento della settimana.
    </p>
  </div>

</div>

<script>
/* VERSIONE ANTI-SCHERMATA-BIANCA */
(function(){

  try {

    const weekBox = document.getElementById("week");
    const levels = document.querySelectorAll(".level");

    levels.forEach(btn=>{
      btn.addEventListener("click",()=>{
        const u = new URL(location.href);
        u.searchParams.set("level", btn.dataset.level);
        location.href = u.toString();
      });
    });

    const params = new URLSearchParams(location.search);
    const level = params.get("level");
    if(!level) return;

    levels.forEach(l=>{
      if(l.dataset.level === level) l.classList.add("active");
    });

    const today = new Date().toISOString().slice(0,10);

    fetch("/runnerschoolitalia/programma/index.html",{cache:"no-store"})
      .then(r=>r.text())
      .then(html=>{
        const temp = document.createElement("div");
        temp.innerHTML = html;

        const levelBlock = temp.querySelector(
          'details.level[data-level="'+level+'"]'
        );

        if(!levelBlock){
          weekBox.innerHTML="<p>Livello non trovato</p>";
          return;
        }

        const weeks = levelBlock.querySelectorAll("details.week");
        let found = null;

        weeks.forEach(w=>{
          if(today >= w.dataset.start && today <= w.dataset.end){
            found = w;
          }
        });

        if(!found){
          weekBox.innerHTML="<p>Nessuna settimana attiva</p>";
          return;
        }

        const clone = found.cloneNode(true);
        clone.removeAttribute("open");

        const t = clone.querySelector(".week-title");
        const d = clone.querySelector(".week-dates");
        if(t && d) t.textContent = t.textContent.trim()+" ‚Äì ";

        weekBox.innerHTML="";
        weekBox.appendChild(clone);
      })
      .catch(()=>{
        weekBox.innerHTML="<p>Errore nel caricamento del programma</p>";
      });

  } catch(e){
    document.body.innerHTML =
      "<p style='padding:20px'>Errore grave JS</p>";
  }

})();
</script>

</body>
</html>

